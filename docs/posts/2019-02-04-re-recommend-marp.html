<!DOCTYPE html>
<html lang="ja">

<head profile="http://www.w3.org/2005/10/profile">
  <meta charset="utf-8">
  <link rel="icon" href="/assets/icon.jpg">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="Re: Marp のすゝめ" />
  <meta property="og:site_name" content="ひげメモ" />
  <meta property="og:image" content="/images//assets/re-recommend-marp/editing&lt;em&gt;marp&lt;/em&gt;next.jpg" />
<title>Re: Marp のすゝめ</title>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/highlight.css">
  <link rel="stylesheet" type="text/css"
    href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />  <link rel="stylesheet" href="/css/syntax.css">
</head>

<body>
  <div class="outer">
    <header class="site-header">
      <div class="wrapper">
        <a class="site-title" href="https://matsubara0507.github.io/">ひげメモ</a>
      </div>
      <div class="header-badge">
        <a href="https://matsubara0507.github.io/">
          <img src="/assets/icon.jpg" />
        </a>
      </div>
    </header>    <div class="page-content">
      <div class="wrapper">
        <article class="post card" itemscope itemtype="http://schema.org/BlogPosting">
          <div class="card-content">
            <header class="post-header">
              <h1 class="post-title" itemprop="name headline">Re: Marp のすゝめ</h1>
              <p class="post-meta">
                <time datetime="$time$" itemprop="datePublished">Feb  4, 2019</time>
              <div class="tags">
                <i class="fa fa-tags"></i>
                <a href="../tags/Marp/1">Marp</a>
              </div>
              </p>
            </header>

            <div class="post-content" itemprop="articleBody">
              <p><strong>2019.4.6 Marp-core-0.6.0 での更新を反映した</strong></p>
<h1 id="section"></h1>
<p><a href="https://yhatt.github.io/marp/">Marp</a> というのは Markdown 記法で書けるスライド作成ツールです．</p>
<ul>
<li>Markdown 記法で手軽に書ける</li>
<li>見た目が綺麗</li>
<li>画像の拡縮が可能</li>
</ul>
<p>などの特徴から個人的にかなり重宝しています． その辺りは昔<a href="/posts/2016-12-14-recommend-marp.html">記事にしました</a>．</p>
<p>しかし，現在 Marp は今後メンテナンスをしないという明言をし，新しくゼロから <a href="https://github.com/marp-team/marp">Marp Next</a> というのを作っているようです． そのあたりの話は作者の記事にすこーしずつ書いてあります:</p>
<ul>
<li><a href="https://yhatt.hatenablog.jp/entry/2017/02/27/markdown-it-incremental-dom_というプラグインを作ってます">markdown-it-incremental-dom というプラグインを作ってます - YHATT (わいはっと)</a></li>
<li><a href="https://qiita.com/yhatt/items/874d5bfa919c32728403">Puppeteer &amp; Carlo を Markdown スライド作成 CLI ツール (Marp CLI) で活用する - Qiita</a></li>
</ul>
<p>時折，リポジトリをチェックして更新がないかを見ていたのですが，いよいよ Web UI まで出来上がっているので，現状のを試しに使ってみることにしました，というメモです．</p>
<h1 id="section-1"></h1>
<p>ちなみに，本記事での Marp Next のバージョンは <code>marp-cli-0.6</code> ぐらいを想定しています(現在開発が活発なので既に古くなっているかも)．</p>
<h2 id="marp-next">Marp Next</h2>
<p>新しい Marp の大きな目的は，よりメンテナブルな設計になることのようで，旧 Marp と異なり，機能ごとに個別の JS パッケージとなっている:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">リポジトリ</th>
<th>備考</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><a href="https://github.com/marp-team/marp">marp-team/marp</a></td>
<td>Marp 全体を取りまとめるリポジトリ</td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="https://github.com/marp-team/marpit">Marpit</a></td>
<td>Markdown からスライドの HTML へ変換する部分 (画像の拡縮などもココ)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="https://github.com/marp-team/marp-core">Marp Core</a></td>
<td>Markdown 以外の拡張構文 (e.g. LaTeX, Emoji, Embed HTML)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><a href="https://github.com/marp-team/marp-cli">Marp CLI</a></td>
<td>Marp の CLI ツール</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><a href="https://github.com/marp-team/marp-web">Marp Web</a></td>
<td>Marp の Web UI (まだベータっぽい)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Marp Desktop</td>
<td>Marp Web を Electron でラップして Desktop アプリにしたいらしい (まだ無い)</td>
</tr>
</tbody>
</table>
<p>(どうでも良いですが，モノリポにした方良かったと思う... Marpit で更新があると全てのリポジトリで PR を出して更新する必要があるので...)</p>
<p>ちなみに，<a href="https://github.com/yhatt/marp/issues?q=is%3Aopen+is%3Aissue+label%3A%22Supports+in+Marp+Next%22">旧 Marp のリポジトリの Issue ラベルに <code>Marp Next</code> や <code>Supports in Marp Next</code> というのができている</a>． 旧 Marp の Issue には，かなり要望っぽい Issue がたくさんあり，その中でも Marp Next では対応する予定のものには <code>Support in Marp Next</code> を付けたようだ．</p>
<h3 id="旧-marp-との非互換な機能">旧 Marp との非互換な機能</h3>
<p>これらは旧 Marp ユーザーしか意味ないが，適当に書き連ねていおく:</p>
<ol>
<li><code>==AAA==</code> というハイライト機能がない（辛い）</li>
<li>打ち消し線記法 <code>~~AAA~~</code> もない</li>
<li>画像の拡縮ルール (Marpit)
<ul>
<li>より<a href="https://marpit.marp.app/image-syntax">細かいルールができて</a>書きやすくなった</li>
<li>しかし前のは記法は非互換</li>
<li><code>center</code> がないので中央寄せができない</li>
</ul></li>
<li><code>&lt;!-- *template: xxx --&gt;</code> のようなそのページだけ機能追加 (Marpit)
<ul>
<li><code>&lt;!-- _class: xxx --&gt;</code> のように先頭にアンダースコア <code>_</code> を付けるスタイルになった</li>
<li>ちなみに <code>&lt;!-- $theme: xxx --&gt;</code> はあるっぽい</li>
</ul></li>
<li>テーマの取り扱い (Marpit ??)
<ul>
<li><code>#</code> だけだと中央寄せなどになっていた機能がなくなった</li>
<li>それらはテーマのイチ <code>class</code> となっている</li>
<li>前の <code>template</code> も <code>class</code> なので組み合わせれない</li>
<li>明示的に指定できるようになったのは嬉しい</li>
<li>class を複数設定できるようになった！ (<a href="https://github.com/marp-team/marp-core/pull/69">marp-core-0.6.0~</a>)</li>
</ul></li>
<li>KaTeX のバージョンアップ (Marp Core)
<ul>
<li>0.6.0 =&gt; 0.10.0</li>
<li>0.6.0 だと全然 LaTeX 記法をサポートしていないので<a href="https://katex.org/docs/supported.html">助かる</a></li>
<li>まぁ僕はフォークしてバージョンをあげてたけど</li>
</ul></li>
<li>スライドのサイズ・縦横比 (Marpit)
<ul>
<li><a href="https://github.com/marp-team/marpit/blob/9ab8e153e66db3a55e8edf9fec1356dd60ddf9e6/docs/theme-css.md#slide-size">テーマごとになったぽい</a>？</li>
<li><a href="https://marpit.marp.app/directives?id=tweak-theme-style"><code>style</code></a> で上書きすると変な余白ができる</li>
<li>どっちにせよ前の <code>&lt;!-- size: 4:3 --&gt;</code> みたいなのはできないっぽい</li>
</ul></li>
</ol>
<p>ちなみに，コードが全部 CoffeScript から TypeScript になってた．</p>
<h2 id="cli-を試す">CLI を試す</h2>
<p>リッチすぎてビビる</p>
<ul>
<li>README の通りで動いた (Mac, npx)
<ul>
<li><code>npx @marp-team/marp-cli slide.md</code></li>
</ul></li>
<li><a href="https://hub.docker.com/r/marpteam/marp-cli/">Docker もサポートされてる</a>
<ul>
<li>ただし一部機能に制限があるっぽい</li>
</ul></li>
<li>Markdown から HTML を生成する</li>
<li><code>--pdf</code> オプションで PDF を生成する
<ul>
<li>ただし <strong><a href="https://github.com/marp-team/marp-cli/pull/10">セキュリティの関係</a>でデフォルトではローカルファイルの画像などを埋め込めない</strong></li>
<li>そのためローカル画像を使うには <code>--allow-local-files</code> をつける</li>
<li>日本語フォントも変になっている気がする</li>
<li>日本語検索もダメっぽい</li>
</ul></li>
<li><code>--watch</code> オプションで Markdown の変更を検知し再生成する</li>
<li><code>--server</code> オプションで <code>localhost:8080</code> で閲覧やPDFの生成ができる (watch もされます)</li>
<li><code>--preview</code> でプレビューモード
<ul>
<li>待望の！！</li>
<li>ブラウザの全画面モードを使ってるみたい</li>
</ul></li>
<li><code>--theme</code> でカスタムテーマを設定可能 (CSS)</li>
<li>CLI のオプションを使わずに<a href="https://github.com/marp-team/marp-cli#configuration-file">設定ファイルでも設定可能</a>
<ul>
<li><code>package.json</code> <code>.marprc.yml</code> <code>marp.config.js</code> のどれでも</li>
</ul></li>
</ul>
<h2 id="cli--netlify-を試す">CLI + Netlify を試す</h2>
<p>試した:</p>
<ul>
<li><a href="https://github.com/matsubara0507/pub-slides">matsubara0507/pub-slides - GitHub</a></li>
</ul>
<p><a href="https://matsubara0507-slides.netlify.com/"><img src="/assets/re-recommend-marp/pub-slides-with-marp.jpg" alt="image.png" /></a></p>
<p>試し方: Marp の作者の<a href="https://github.com/yhatt/marp-cli-example">リポジトリ</a>の <code>Deploy to netlify</code> をクリックするだけ．</p>
<p>この方法の場合，リポジトリの <code>PITCHME.md</code> を <code>index.html</code> に変換する． marp-cli の設定は <code>package.yml</code> に書いてある． <a href="https://github.com/marp-team/marp-cli#options">設定方法</a>はこれを参照．</p>
<p>僕はできれば，複数のスライドを一つのリポジトリに置きたかった． ので，僕のリポジトリでは:</p>
<ul>
<li><code>slides</code> 以下の <code>*.md</code> を全部変換
<ul>
<li><code>index.md</code> が <code>index.html</code> のスライドになる</li>
</ul></li>
<li>後述する自作テーマをサブモジュールで設定</li>
<li><code>slides/assets</code> にある画像を <code>public</code> にコピーしてる</li>
</ul>
<p>のように少しだけ設定を書き換えた．</p>
<h2 id="web-ui-を試す">Web UI を試す</h2>
<p>すでに<a href="https://web.marp.app/">ここ</a>から試せる． 手元で試すなら:</p>
<pre><code>git clone https://github.com/marp-team/marp-web.git
cd marp-web
yarn install
yarn start</code></pre>
<p>でできた．</p>
<p><img src="/assets/re-recommend-marp/editing_marp_next.jpg" /></p>
<ul>
<li>ファイルの読み込みや保存が可能</li>
<li>プレゼンテーションモードは(まだ)なかった</li>
<li>PDFのエクスポートはブラウザの印刷機能を使うようだった</li>
<li>カスタムテーマの設定などはまだできない？？</li>
</ul>
<h2 id="テーマを移植する">テーマを移植する</h2>
<p>オリジナルテーマを作ってたので Marp Next にも移植した:</p>
<ul>
<li>olive</li>
<li>colors</li>
<li>haskell</li>
</ul>
<p><a href="https://github.com/matsubara0507/marp-themes">marp-themes</a> というリポジトリを作り，そこに置いてある． やったことは:</p>
<ul>
<li><a href="https://github.com/marp-team/marp-core/blob/26f2402d443d26af387adb0ee86cafa1149beb34/themes/gaia.scss">gaia の scss</a> を持ってきて主に色を変更
<ul>
<li>カスタムテーマとして指定できるのは CSS だけなので <code>scss</code> コマンドで手動変換する</li>
</ul></li>
<li>画像の中央寄せをできるようにした
<ul>
<li><code># ![](path/to/image.jpg)</code> とすると中央寄せになるようにした</li>
<li><code>h1</code> から <code>h6</code> のどれでも良いです</li>
<li>ただし，雑に <code>img</code> タグに適用してるので emoji を含ませるとずれる...</li>
<li>marpit に修正入れてもらった方が良いかな</li>
</ul></li>
<li><code>lead</code> + <code>invert</code> などの class を作っておいた
<ul>
<li>scss で書いてるので <code>lead</code> を適当に mixi-in にして include するだけ</li>
<li>これもできれば <code>class</code> の組み合わせができるようになって欲しい</li>
<li>marp-core-0.6.0 から class を複数設定できるようになったので、これはいらない ;)</li>
</ul></li>
</ul>
<h3 id="olive">Olive</h3>
<iframe src="//www.slideshare.net/slideshow/embed_code/key/797Uraln5Fo9gD" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen>
</iframe>
<h3 id="colors">Colors</h3>
<iframe src="//www.slideshare.net/slideshow/embed_code/key/2kOvCIcUpOzKRg" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen>
</iframe>
<h3 id="haskell">Haskell</h3>
<iframe src="//www.slideshare.net/slideshow/embed_code/key/kJqmkk54SJnaky" width="595" height="485" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen>
</iframe>
<h2 id="おしまい">おしまい</h2>
<p>もう既に十分使える状態になっていました． すごい！</p>
            </div>

            <footer class="post-footer">
              <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button"
                data-show-count="false">Tweet</a>
              <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            </footer>
          </div>
        </article>
      </div>
    </div>
    <footer class="site-footer">
      <div class="wrapper">
        <span class="footer-heading">ひげメモ</span>
      </div>
      <div class="page-content card" style="display: flex; justify-content: center; padding: 5px 0px">
        <a href="https://haskell.jp/blog/posts/links.html#matsubara0507.github.io">
          <img width="234" src="https://haskell.jp/img/supported-by-haskell-jp.svg" alt="Supported By Haskell-jp.">
        </a>
      </div>
    </footer>  </div>
</body>