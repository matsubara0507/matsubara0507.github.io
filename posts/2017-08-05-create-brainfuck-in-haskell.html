<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html lang="ja">

  <head>
  <meta charset="utf-8">
  <link rel="icon" href="../assets/icon.jpg">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
    
      <meta property="og:title" content="Haskell で書く Brainf*ck 処理系" />
    
  

  <meta property="og:site_name" content="ひげメモ" />

  

  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-86386380-1', 'auto');
  ga('send', 'pageview');
</script>

  

  <title>
    
      
        Haskell で書く Brainf*ck 処理系
      
    
  </title>

  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/highlight.css">
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
</head>


  <body>
      <div class="outer">

        <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="https://matsubara0507.github.io/">ひげメモ</a>

  </div>

  <div class="header-badge">
    <a href="https://matsubara0507.github.io/">
        <img src="../assets/icon.jpg" />
    </a>
  </div>

</header>


        <div class="page-content">
          <div class="wrapper">
            <article class="post card" itemscope itemtype="http://schema.org/BlogPosting">
 <div class="card-content">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Haskell で書く Brainf*ck 処理系</h1>
    <p class="post-meta">
      <time datetime="2017-08-05" itemprop="datePublished">
        Aug 5, 2017
      </time>
      
      
      <div class="tags">
          <i class="fa fa-tags"></i> <a href="../tags/Haskell.html">Haskell</a> <a href="../tags/Brainfuck.html">Brainfuck</a> <a href="../tags/application.html">application</a>
      </div>
      
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>何番煎じだよって感じのネタですが，久々に Brainf*ck のコードを見かけたので，久々に書いてみたくなりました．</p>
<h2 id="いきさつ">いきさつ</h2>
<p>先日，<a href="https://builderscon.io/tokyo/2017">builderscon in tokyo 2017</a> というイベントに行ってきた． そこのフリードリンクコーナーにこんな紙コップが…</p>
<p><img src="../assets/create-brainfuck-in-haskell/braincup.jpg" /></p>
<p>一流のプログラマであれば，Brainf*ck 程度の単純な処理系ぐらい目実行しろってことだろうが，ボクは3流程度のプログラマなので，<a href="http://e-words.jp/p/r-ascii.html">ASCIIコード表</a>が片手にないと実行できなかった…orz</p>
<p>まぁ内容はわかったのだが，せっかくだから久々にサクッと書いてみようと思ったわけです．</p>
<h2 id="brainfck">Brainf*ck</h2>
<p>Brainf*ck の処理系は，コードの見た目こそ気持ち悪いが非常に単純．</p>
<ul>
<li>コードは8文字 <code>&gt;&lt;+-.,[]</code> だけで構成される(それ以外は無視)</li>
<li>コードを頭から一文字ずつ読んで実行していく</li>
<li>一本の無限に長いテープ(メモリ)を考える</li>
<li>テープは全て <code>0</code> で初期化されてる</li>
<li>プログラムはテープの数値の変更や読み取りができる</li>
</ul>
<p>といった感じ． 具体的には以下の通り(<a href="https://ja.wikipedia.org/wiki/Brainfuck">Wikipedia</a>より)．</p>
<ol type="1">
<li><code>&gt;</code> ポインタをインクリメント，ポインタを <code>ptr</code> とすると，C言語の <code>ptr++</code> に相当</li>
<li><code>&lt;</code> ポインタをデクリメント，C言語の <code>ptr--</code> に相当</li>
<li><code>+</code> ポインタが指す値をインクリメント，C言語の <code>(*ptr)++</code> に相当</li>
<li><code>-</code> ポインタが指す値をデクリメント，C言語の <code>(*ptr)--</code> に相当</li>
<li><code>.</code> ポインタが指す値を出力に書き出す，C言語の <code>putchar(*ptr)</code> に相当</li>
<li><code>,</code> 入力から1バイト読み込んでポインタが指す先に代入，C言語の <code>*ptr=getchar()</code> に相当</li>
<li><code>[</code> ポインタが指す値が0なら対応する <code>]</code> の直後にジャンプ，C言語の <code>while(*ptr){</code> に相当</li>
<li><code>]</code> ポインタが指す値が0でないなら対応する <code>[</code> にジャンプ，C言語の <code>}</code> に相当</li>
</ol>
<h2 id="作る">作る</h2>
<p>最終的なコードは<a href="https://gist.github.com/matsubara0507/d855acd68a7fd54005b7f04b104cd8e6#file-brainfuck-hs">ココ</a>にある．</p>
<h3 id="実行機の型を考える">実行機の型を考える</h3>
<p>関数型プログラミングは，まず型から考える(自論)．</p>
<p>前述したとおり，Brainf*ck の実行機は，プログラム列と無限に長いテープ(メモリ)があればよい． 組込みのリスト(単方向リスト)でも良いが，テープの上を前後(か左右)に移動するので双方向リストの方が良いだろう．</p>
<p>Haskell で双方向リストを実装するやり方はいろいろあるが，今回は便宜上以下のようにする．</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">data</span> <span class="dt">Tape</span> a <span class="fu">=</span> <span class="dt">Tape</span> {<span class="ot"> front ::</span> [a]</a>
<a class="sourceLine" id="cb1-2" title="2">                   ,<span class="ot"> current ::</span> a</a>
<a class="sourceLine" id="cb1-3" title="3">                   ,<span class="ot"> back ::</span> [a]</a>
<a class="sourceLine" id="cb1-4" title="4">                   } <span class="kw">deriving</span> (<span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="ot">mapCrr ::</span> (a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> <span class="dt">Tape</span> a <span class="ot">-&gt;</span> <span class="dt">Tape</span> a</a>
<a class="sourceLine" id="cb1-7" title="7">mapCrr f tape <span class="fu">=</span> tape { current <span class="fu">=</span> f (current tape) }</a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="ot">moveFront ::</span> <span class="dt">Tape</span> a <span class="ot">-&gt;</span> <span class="dt">Tape</span> a</a>
<a class="sourceLine" id="cb1-10" title="10">moveFront (<span class="dt">Tape</span> [] _ _) <span class="fu">=</span> <span class="fu">error</span> <span class="st">&quot;front is empty.&quot;</span></a>
<a class="sourceLine" id="cb1-11" title="11">moveFront (<span class="dt">Tape</span> f c b) <span class="fu">=</span> <span class="dt">Tape</span> (<span class="fu">tail</span> f) (<span class="fu">head</span> f) (c <span class="fu">:</span> b)</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="ot">moveBack ::</span> a <span class="ot">-&gt;</span> <span class="dt">Tape</span> a <span class="ot">-&gt;</span> <span class="dt">Tape</span> a</a>
<a class="sourceLine" id="cb1-14" title="14">moveBack a (<span class="dt">Tape</span> f c []) <span class="fu">=</span> <span class="dt">Tape</span> (c <span class="fu">:</span> f) a []</a>
<a class="sourceLine" id="cb1-15" title="15">moveBack _ (<span class="dt">Tape</span> f c b) <span class="fu">=</span> <span class="dt">Tape</span> (c <span class="fu">:</span> f) (<span class="fu">head</span> b) (<span class="fu">tail</span> b)</a></code></pre></div>
<p>用意した関数は以下の3つだけ(これだけで十分だから)．</p>
<ul>
<li><code>mapCrr</code> は現在の値にのみ，第一引数の関数 <code>f</code> を適用する</li>
<li><code>moveFront</code> はテープのヘッダを前進させる</li>
<li><code>moveBack</code> はテープのヘッダを後進させる
<ul>
<li>ただし，後ろへ無限に長いとするので，初期化値 <code>a</code> を引数で与えている</li>
</ul></li>
</ul>
<p>テープには数値を印字しているので，テープ(メモリ)の型は <code>Tape Int</code> でいいでしょう．</p>
<h2 id="section"></h2>
<p>あと必要なのはプログラムの型． プログラムも前から順に読んでいき，<code>[]</code> で前後にジャンプする． つまり，<code>Tape a</code> 型をそのまま使えそうだ． <code>Tape Char</code> でも良いが，終端文字が欲しいので(冗長だが) <code>Tape (Maybe Char)</code> とする．</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">type</span> <span class="dt">Program</span> <span class="fu">=</span> <span class="dt">Tape</span> (<span class="dt">Maybe</span> <span class="dt">Char</span>)</a></code></pre></div>
<p>結果として実行機の型は以下のようになる．</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">data</span> <span class="dt">Machine</span> <span class="fu">=</span> <span class="dt">Machine</span> {<span class="ot"> programOf ::</span> <span class="dt">Program</span></a>
<a class="sourceLine" id="cb3-2" title="2">                       ,<span class="ot"> memOf ::</span> <span class="dt">Tape</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb3-3" title="3">                       } <span class="kw">deriving</span> (<span class="dt">Show</span>)</a></code></pre></div>
<h3 id="初期化関数">初期化関数</h3>
<p>テストするために，<code>String -&gt; Machine</code> の初期化関数を先に作っておく．</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" title="1"><span class="ot">initMachine ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Machine</span></a>
<a class="sourceLine" id="cb4-2" title="2">initMachine <span class="fu">=</span> initMachine' <span class="fu">.</span> <span class="fu">flip</span> <span class="fu">mappend</span> [fin] <span class="fu">.</span> <span class="fu">fmap</span> <span class="dt">Just</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-4" title="4">    initMachine' s <span class="fu">=</span> <span class="dt">Machine</span> (<span class="dt">Tape</span> [] (<span class="fu">head</span> s) (<span class="fu">tail</span> s)) (<span class="dt">Tape</span> [] <span class="dv">0</span> [])</a>
<a class="sourceLine" id="cb4-5" title="5"></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="ot">fin ::</span> <span class="dt">Maybe</span> <span class="dt">Char</span></a>
<a class="sourceLine" id="cb4-7" title="7">fin <span class="fu">=</span> <span class="dt">Nothing</span></a></code></pre></div>
<p><code>flip mappend [fin] . fmap Just</code> は，<code>Char</code> 型の値を <code>Just</code> にラップし，空文字 <code>&quot;&quot;</code> 対策として終端文字を末尾に足している．</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" title="1"><span class="fu">&gt;</span> prog <span class="fu">=</span> <span class="st">&quot;+[-]&quot;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="fu">&gt;</span> initMachine prog</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="dt">Machine</span> {programOf <span class="fu">=</span> <span class="dt">Tape</span> {front <span class="fu">=</span> [], current <span class="fu">=</span> <span class="dt">Just</span> <span class="ch">'+'</span>, back <span class="fu">=</span> [<span class="dt">Just</span> <span class="ch">'['</span>,<span class="dt">Just</span> <span class="ch">'-'</span>,<span class="dt">Just</span> <span class="ch">']'</span>,<span class="dt">Nothing</span>]}, memOf <span class="fu">=</span> <span class="dt">Tape</span> {front <span class="fu">=</span> [], current <span class="fu">=</span> <span class="dv">0</span>, back <span class="fu">=</span> []}}</a></code></pre></div>
<h3 id="実行する関数">実行する関数</h3>
<p>基本の動作は</p>
<ol type="1">
<li>一文字分を読み込んで</li>
<li>対応する処理をし</li>
<li>次の文字へ移動</li>
</ol>
<p>を終端文字(<code>Nothing</code>)まで繰り返す．</p>
<p>2 の部分に IO が含まれる可能性があるので，1-3 の処理は <code>Machine -&gt; IO Machine</code> となる． 特別意味はないがループ部分と処理部分を分けてみた．</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" title="1"><span class="ot">run ::</span> <span class="dt">Machine</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Machine</span></a>
<a class="sourceLine" id="cb6-2" title="2">run <span class="fu">=</span> loopM run' ((<span class="fu">/=</span>) fin <span class="fu">.</span> current <span class="fu">.</span> programOf)</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="ot">loopM ::</span> <span class="dt">Monad</span> m <span class="ot">=&gt;</span> (a <span class="ot">-&gt;</span> m a) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> m a</a>
<a class="sourceLine" id="cb6-5" title="5">loopM f p a <span class="fu">=</span> <span class="kw">if</span> p a <span class="kw">then</span> f a <span class="fu">&gt;&gt;=</span> loopM f p <span class="kw">else</span> <span class="fu">return</span> a</a>
<a class="sourceLine" id="cb6-6" title="6"></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="ot">run' ::</span> <span class="dt">Machine</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Machine</span></a>
<a class="sourceLine" id="cb6-8" title="8">run' <span class="fu">=</span> <span class="fu">undefined</span></a></code></pre></div>
<p><code>(/=) fin . current . programOf</code> の部分は <code>Machine</code> 型の値から現在見てるコードの文字が終端文字(<code>Nothing</code>)かどうかを判定している． <code>loopM f p a</code> は <code>p a</code> が <code>False</code> になるまで，<code>f a</code> を繰り返し適用している．</p>
<h3 id="処理部分">処理部分</h3>
<p>あとは処理部分を分岐して書くだけ．</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">import</span> <span class="dt">Data.Char</span> (chr, ord)</a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="ot">run' ::</span> <span class="dt">Machine</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Machine</span></a>
<a class="sourceLine" id="cb7-4" title="4">run' m<span class="fu">@</span>(<span class="dt">Machine</span> prog mem) <span class="fu">=</span></a>
<a class="sourceLine" id="cb7-5" title="5">  (\m' <span class="ot">-&gt;</span> m' { programOf <span class="fu">=</span> moveBack' <span class="fu">$</span> programOf m' }) <span class="fu">&lt;$&gt;</span> cond (current prog)</a>
<a class="sourceLine" id="cb7-6" title="6">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb7-7" title="7">    cond (<span class="dt">Just</span> <span class="ch">'&gt;'</span>) <span class="fu">=</span> <span class="fu">return</span> <span class="fu">$</span> <span class="dt">Machine</span> prog (moveBack <span class="dv">0</span> mem)</a>
<a class="sourceLine" id="cb7-8" title="8">    cond (<span class="dt">Just</span> <span class="ch">'&lt;'</span>) <span class="fu">=</span> <span class="fu">return</span> <span class="fu">$</span> <span class="dt">Machine</span> prog (moveFront mem)</a>
<a class="sourceLine" id="cb7-9" title="9">    cond (<span class="dt">Just</span> <span class="ch">'+'</span>) <span class="fu">=</span> <span class="fu">return</span> <span class="fu">$</span> <span class="dt">Machine</span> prog (mapCrr (<span class="fu">+</span> <span class="dv">1</span>) mem)</a>
<a class="sourceLine" id="cb7-10" title="10">    cond (<span class="dt">Just</span> <span class="ch">'-'</span>) <span class="fu">=</span> <span class="fu">return</span> <span class="fu">$</span> <span class="dt">Machine</span> prog (mapCrr (<span class="fu">+</span> (<span class="fu">-</span><span class="dv">1</span>)) mem)</a>
<a class="sourceLine" id="cb7-11" title="11">    cond (<span class="dt">Just</span> <span class="ch">'.'</span>) <span class="fu">=</span> <span class="fu">return</span> m <span class="fu">&lt;*</span> <span class="fu">putChar</span> (<span class="fu">chr</span> <span class="fu">$</span> current mem)</a>
<a class="sourceLine" id="cb7-12" title="12">    cond (<span class="dt">Just</span> <span class="ch">','</span>) <span class="fu">=</span></a>
<a class="sourceLine" id="cb7-13" title="13">      (\c <span class="ot">-&gt;</span> <span class="dt">Machine</span> prog (mapCrr (<span class="fu">const</span> <span class="fu">$</span> <span class="fu">ord</span> c) mem)) <span class="fu">&lt;$&gt;</span> <span class="fu">getChar</span></a>
<a class="sourceLine" id="cb7-14" title="14">    cond (<span class="dt">Just</span> <span class="ch">'['</span>) <span class="fu">=</span> <span class="fu">return</span> <span class="fu">.</span> <span class="fu">flip</span> <span class="dt">Machine</span> mem <span class="fu">$</span></a>
<a class="sourceLine" id="cb7-15" title="15">      (<span class="kw">if</span> current mem <span class="fu">==</span> <span class="dv">0</span> <span class="kw">then</span> jump (<span class="ch">'['</span>, <span class="ch">']'</span>) moveBack' <span class="kw">else</span> <span class="fu">id</span>) prog</a>
<a class="sourceLine" id="cb7-16" title="16">    cond (<span class="dt">Just</span> <span class="ch">']'</span>) <span class="fu">=</span> <span class="fu">return</span> <span class="fu">.</span> <span class="fu">flip</span> <span class="dt">Machine</span> mem <span class="fu">$</span></a>
<a class="sourceLine" id="cb7-17" title="17">      (<span class="kw">if</span> current mem <span class="fu">/=</span> <span class="dv">0</span> <span class="kw">then</span> jump (<span class="ch">']'</span>, <span class="ch">'['</span>) moveFront <span class="kw">else</span> <span class="fu">id</span>) prog</a>
<a class="sourceLine" id="cb7-18" title="18">    cond _   <span class="fu">=</span> <span class="fu">return</span> m</a>
<a class="sourceLine" id="cb7-19" title="19">    moveBack' <span class="fu">=</span> moveBack fin</a>
<a class="sourceLine" id="cb7-20" title="20"></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="ot">jump ::</span> (<span class="dt">Char</span>, <span class="dt">Char</span>) <span class="ot">-&gt;</span> (<span class="dt">Program</span> <span class="ot">-&gt;</span> <span class="dt">Program</span>) <span class="ot">-&gt;</span> <span class="dt">Program</span> <span class="ot">-&gt;</span> <span class="dt">Program</span></a>
<a class="sourceLine" id="cb7-22" title="22">jump (a, b) f <span class="fu">=</span> go <span class="dv">1</span></a>
<a class="sourceLine" id="cb7-23" title="23">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb7-24" title="24">    go <span class="dv">0</span> prog <span class="fu">=</span> prog</a>
<a class="sourceLine" id="cb7-25" title="25">    go n prog <span class="fu">=</span> go (updateCounter (p a) (p b) (current <span class="fu">$</span> f prog) n) (f prog)</a>
<a class="sourceLine" id="cb7-26" title="26">    p x <span class="fu">=</span> (<span class="fu">==</span>) (<span class="dt">Just</span> x)</a>
<a class="sourceLine" id="cb7-27" title="27"></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="ot">updateCounter ::</span> (a <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb7-29" title="29">updateCounter p q a <span class="fu">=</span> (<span class="fu">+</span>) (<span class="kw">if</span> p a <span class="kw">then</span> <span class="dv">1</span> <span class="kw">else</span> <span class="kw">if</span> q a <span class="kw">then</span> <span class="fu">-</span><span class="dv">1</span> <span class="kw">else</span> <span class="dv">0</span>)</a></code></pre></div>
<p><code>\m' -&gt; m' { programOf = moveBack' $ programOf m' }</code> が「3. 次の文字へ移動」にあたり，<code>cond (current prog)</code> が「1. 一文字分を読み込んで」にあたる．</p>
<p><code>cond</code> 補助関数が 2. にあたる． <code>[</code> (ないしは <code>]</code>)の移動は <code>jump</code> 関数を利用して，単純に一個ずつ前(ないしは後ろ)に移動し，対応する <code>]</code> (ないしは <code>[</code>)を探している(<strong>そのため，対応していないと止まらない</strong>)． 対応してるかどうかは <code>go n</code> の <code>n</code> をカウンターとして保持している． <code>updateCounter</code> 関数は，そのカウンターを更新するための関数である．</p>
<h3 id="main-関数">Main 関数</h3>
<p>別に要らないけど</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">import</span> <span class="dt">System.Environment</span> (getArgs)</a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb8-4" title="4">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb8-5" title="5">  [filepath] <span class="ot">&lt;-</span> getArgs</a>
<a class="sourceLine" id="cb8-6" title="6">  prog <span class="ot">&lt;-</span> <span class="fu">readFile</span> filepath</a>
<a class="sourceLine" id="cb8-7" title="7">  _ <span class="ot">&lt;-</span> run <span class="fu">$</span> initMachine prog</a>
<a class="sourceLine" id="cb8-8" title="8">  <span class="fu">putStrLn</span> <span class="st">&quot;&quot;</span></a></code></pre></div>
<h2 id="実行">実行</h2>
<p>試しに，<del>Wikipedia にある</del>(Wikipeia の「Hello worldプログラムの一覧」のページが無くなってた…orz) HelloWorld プログラムを実行してみる．</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1">$ <span class="fu">cat</span> hw.bf</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="ex">+++++++++</span>[<span class="op">&gt;</span>++++++++<span class="op">&gt;</span>+++++++++++<span class="op">&gt;</span>+++++<span class="op">&lt;&lt;&lt;</span>-]<span class="op">&gt;</span>.<span class="op">&gt;</span>++.+++++++..+++.<span class="op">&gt;</span>-.</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="ex">------------.</span><span class="op">&lt;</span>++++++++.--------.+++.------.--------.<span class="op">&gt;</span>+.</a>
<a class="sourceLine" id="cb9-4" title="4">$ <span class="ex">stack</span> runghc brainfuck.hs hw.bf</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="ex">Hello</span>, world!</a></code></pre></div>
<p>紙コップのやつは，まぁ，自分でやってみて．</p>
<h2 id="おしまい">おしまい</h2>
<p>もっとコンパクトに書こうと思えば書けるけど，なんか綺麗なので満足． <a href="https://gist.github.com/matsubara0507/d855acd68a7fd54005b7f04b104cd8e6#file-_brainfuck-hs">2,3年前に書いたモノ</a>と比べると，成長した気がする(笑)</p>
  </div>
</div>
</article>

          </div>
        </div>

        <footer class="site-footer">

  <div class="wrapper">

    <span class="footer-heading">ひげメモ</span>

  </div>

  <div class="page-content card" style="display: flex; justify-content: center; padding: 5px 0px">
    <a href="https://haskell.jp/blog/posts/links.html#matsubara0507.github.io">
      <img width="234" src="https://haskell.jp/img/supported-by-haskell-jp.svg" alt="Supported By Haskell-jp.">
    </a>
  </div>

</footer>


      </div>
  </body>

</html>
